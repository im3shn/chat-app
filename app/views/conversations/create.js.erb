var conversations = $('#conversations-list');
var conversation = conversations.find("[data-conversation-id='" + "<%= @conversation.id %>" + "']");
if (conversation.length !== 1) {
    conversations.prepend("<%= j(render 'conversations/conversation', conversation: @conversation, user: current_user) %>");
    conversation = conversations.find("[data-conversation-id='" + "<%= @conversation.id %>" + "']");
}else{
    conversation.remove();
    conversations.prepend("<%= j(render 'conversations/conversation', conversation: @conversation, user: current_user) %>");
    conversation = conversations.find("[data-conversation-id='" + "<%= @conversation.id %>" + "']");
}

var x = conversation.find('.conversation-panel')
x.collapse('show');
conversations = $('#conversations-list');
var height = conversations[0].scrollHeight;
conversations.scrollToTop(height);